{% extends "base.html" %}

{% block content %}
<div class="min-h-screen flex flex-col">
  <div class="flex flex-1">
  <!-- Sidebar -->
  <aside class="w-64 bg-gray-100 p-6 border-r">
    <h2 class="text-xl font-bold mb-6">Physiotherapist</h2>
    <ul id="sidebarLinks" class="space-y-4 text-gray-700">
      <li><a href="#profile" class="sidebar-link text-indigo-700 font-semibold">Profile</a></li>
      <li><a href="#patient-info" class="sidebar-link hover:underline">Patient Info</a></li>
      <li><a href="#schedule" class="sidebar-link hover:underline">Care Schedule</a></li>
      <li><a href="#support-plan" class="sidebar-link hover:underline">Support Plan</a></li>
      <li><a href="#report-record" class="sidebar-link hover:underline">Report Record</a></li>
      <li><a href="#analysis" class="sidebar-link hover:underline">Data Analysis</a></li>
    </ul>
  </aside>

<!-- Right Content Wrapper -->
<div class="flex-1 flex flex-col">
  <main class="p-8 flex-1">
   <!-- Profile Section -->
<section id="profile" class="content-section">
    <!-- Personal Information Card -->
    <div class="bg-white rounded-lg shadow p-6 mb-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
      <h3 class="text-xl font-bold mb-4">Personal Information</h3>
      <div class="flex items-center gap-8 mb-6 relative">
        <div class="w-40 h-40">
          <img src="{{ url_for('static', filename='images/therapist_photo.jpg') }}" 
               alt="Physiotherapist Photo" 
               class="w-full h-full object-cover rounded-full border-4 border-indigo-500">
        </div>
        <div class="grid grid-cols-1 gap-2 text-gray-800">
          <p><strong>Name:</strong> Dr. Zhang Wei</p>
          <p><strong>Email:</strong> physio@example.com</p>
          <p><strong>Phone:</strong> 0412-345-678</p>
          <p><strong>Position:</strong> Chief Physiotherapist</p>
          <p><strong>Specialty:</strong> Rehabilitation & Mobility Recovery</p>
        </div>
        <p class="absolute bottom-0 right-0 text-xs text-gray-500">Account Created: 2024-03-15</p>
      </div>
    </div>

    <!-- Clinical Strengths Card -->
    <div class="bg-white rounded-lg shadow p-6 mb-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
      <h4 class="text-xl font-bold mb-4">Clinical Strengths</h4>
      <ul class="list-disc pl-6 text-gray-700">
        <li>Post-surgery physical recovery</li>
        <li>Spine & joint rehabilitation</li>
        <li>Chronic pain management</li>
        <li>Strength training after stroke</li>
      </ul>
    </div>

    <!-- Education Card -->
    <div class="bg-white rounded-lg shadow p-6 mb-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
      <h4 class="text-xl font-bold mb-4">Education</h4>
      <ul class="list-disc pl-6 text-gray-700 space-y-1">
        <li>2010 – Bachelor of Nursing, University of Sydney</li>
        <li>2012 – Master of Nursing (Clinical Leadership), University of Melbourne</li>
      </ul>
    </div>

    <!-- Work Experience Card -->
    <div class="bg-white rounded-lg shadow p-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
      <h4 class="text-xl font-bold mb-4">Work Experience</h4>
      <ul class="list-disc pl-6 text-gray-700 space-y-1">
        <li>2012–2015: Registered Nurse, Royal Melbourne Hospital</li>
        <li>2015–2018: Senior Nurse, Royal Melbourne Hospital</li>
        <li>2018–Present: Head of Physiotherapy Department</li>
      </ul>
    </div>
</section>

   <!-- Patient Information Section -->
<section id="patient-info" class="content-section hidden mb-8">
  <!-- Patient 1 Card -->
  <div class="bg-white rounded-lg shadow p-6 mb-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
    <div class="flex gap-8">
      <div class="w-48 h-48">
        <img src="{{ url_for('static', filename='images/patient_photo.jpg') }}" 
             alt="Patient Photo" 
             class="w-full h-full object-cover rounded-lg border-4 border-indigo-500">
      </div>
      <div class="flex-1 space-y-4">
        <div class="pb-4">
          <h4 class="font-semibold mb-2">Basic Details</h4>
          <p class="text-gray-600">Name: <span class="text-gray-800">Li Dahua</span></p>
          <p class="text-gray-600">Patient ID: <span class="text-gray-800">PT20240315001</span></p>
          <p class="text-gray-600">Insurance Number: <span class="text-gray-800">A123456789</span></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Patient 2 Card -->
  <div class="bg-white rounded-lg shadow p-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
    <div class="flex gap-8">
      <div class="w-48 h-48">
        <img src="{{ url_for('static', filename='images/patient_photo.jpg') }}" 
             alt="Patient Photo" 
             class="w-full h-full object-cover rounded-lg border-4 border-indigo-500">
      </div>
      <div class="flex-1 space-y-4">
        <div class="pb-4">
          <h4 class="font-semibold mb-2">Basic Details</h4>
          <p class="text-gray-600">Name: <span class="text-gray-800">Zhao Wu</span></p>
          <p class="text-gray-600">Patient ID: <span class="text-gray-800">PT20240315002</span></p>
          <p class="text-gray-600">Insurance Number: <span class="text-gray-800">B987654321</span></p>
        </div>
      </div>
    </div>
  </div>
</section>

    <!-- Care Schedule Section -->
<section id="schedule" class="content-section hidden">
  <div class="bg-white rounded-lg shadow p-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
    <h3 class="text-xl font-bold mb-4">Care Schedule</h3>
    <table class="w-full border-collapse border border-gray-300">
      <thead>
        <tr class="bg-gray-100">
          <th class="border border-gray-300 px-4 py-2 font-bold">Time</th>
          <th class="border border-gray-300 px-4 py-2 font-bold">Activity</th>
          <th class="border border-gray-300 px-4 py-2 font-bold">Assigned Staff</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="border border-gray-300 px-4 py-2">09:00</td>
          <td class="border border-gray-300 px-4 py-2">Morning Care</td>
          <td class="border border-gray-300 px-4 py-2">Nurse Ms. Chen</td>
        </tr>
        <tr>
          <td class="border border-gray-300 px-4 py-2">14:00</td>
          <td class="border border-gray-300 px-4 py-2">Rehabilitation Exercise</td>
          <td class="border border-gray-300 px-4 py-2">Physiotherapist Mr. Lin</td>
        </tr>
        <tr>
          <td class="border border-gray-300 px-4 py-2">19:00</td>
          <td class="border border-gray-300 px-4 py-2">Evening Care</td>
          <td class="border border-gray-300 px-4 py-2">Nurse Ms. Wang</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

    <!-- Support Plan Section -->
<section id="support-plan" class="content-section hidden">
    <div class="bg-white rounded-lg shadow p-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
      <h3 class="text-xl font-bold mb-6">Support Plan</h3>
  
      <!-- Patient and Date Selection -->
      <div class="grid grid-cols-2 gap-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Select Patient</label>
          <select id="patient-select" class="w-full border rounded-md px-3 py-2">
            <option value="">-- Select Patient --</option>
            <option value="Zhao Wu">Zhao Wu</option>
            <option value="Li Dahua">Li Dahua</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Date</label>
          <input type="date" id="plan-date" class="w-full border rounded-md px-3 py-2" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Valid Until</label>
          <input type="date" id="valid-until" class="w-full border rounded-md px-3 py-2" />
        </div>
      </div>
  
      <!-- Auto-Fill Patient Info -->
      <div id="patient-info" class="bg-gray-50 p-4 rounded space-y-2 text-sm text-gray-800 hidden">
        <h4 class="font-semibold text-base mb-2">Patient Basic Information</h4>
        <p id="patient-name"></p>
        <p id="patient-id"></p>
        <p id="patient-gender"></p>
        <p id="patient-age"></p>
      </div>
  
      <!-- Fillable Sections -->
      <div class="space-y-6 mt-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Rehabilitation Goals</label>
          <textarea id="goals" rows="3" class="w-full border rounded-md px-3 py-2"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Therapy Recommendations</label>
          <textarea id="therapy" rows="3" class="w-full border rounded-md px-3 py-2"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Daily Living Assistance</label>
          <textarea id="assistance" rows="3" class="w-full border rounded-md px-3 py-2"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Data Tracking Focus</label>
          <textarea id="tracking" rows="3" class="w-full border rounded-md px-3 py-2"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Exercise Prescription Library</label>
          <textarea id="exercise" rows="3" class="w-full border rounded-md px-3 py-2"></textarea>
        </div>
      </div>
  
      <!-- Preview and Submit -->
      <div class="mt-8">
        <h4 class="text-lg font-bold mb-4">Summary Preview</h4>
        <div id="summary" class="bg-gray-100 p-4 rounded space-y-3 text-sm"></div>
        <button id="submit-plan" class="mt-6 bg-indigo-600 text-white px-6 py-2 rounded hover:bg-indigo-700">Send to Guardian</button>
      </div>
    </div>
  </section>
  

    <!-- Report Record Section -->
<section id="report-record" class="content-section hidden">
<div class="max-w-5xl mx-auto bg-white rounded-lg shadow p-6 transition duration-300 ease-in-out hover:shadow-lg hover:scale-[1.01]">
<h3 class="text-xl font-bold mb-6">Patient History</h3>
<!-- Selection Area -->
<div class="grid grid-cols-2 gap-6 mb-8">
  <div class="bg-gray-50 rounded-lg p-4">
    <div class="flex justify-between items-center mb-3">
      <span class="font-medium text-gray-700">Report Date:</span>
      <input class="border rounded-md px-3 py-1.5 bg-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" id="reportDate" type="date"/>
    </div>
    <div class="flex justify-between items-center">
      <span class="font-medium text-gray-700">Support Worker:</span>
      <span class="text-gray-900 font-medium" id="supportWorkerName">No Data</span>
    </div>
  </div>
  <div class="bg-gray-50 rounded-lg p-4">
    <div class="flex justify-between items-center">
      <span class="font-medium text-gray-700">Patient Name:</span>
      <select class="border rounded-md px-3 py-1.5 bg-white w-48 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
        <option value="James Wilson">James Wilson</option>
        <option value="Oliver Thompson">Oliver Thompson</option>
        <option value="William Parker">William Parker</option>
      </select>
    </div>
  </div>
</div>
<!-- Table Area -->
<div class="overflow-hidden rounded-lg border border-gray-200">
  <table class="w-full border-collapse">
    <thead>
      <tr class="bg-gray-100">
        <th class="text-gray-800 align-middle text-sm w-12 py-3 px-4 text-center font-semibold border-gray-200 border-b whitespace-nowrap">No.</th>
        <th class="border-b border-gray-200 px-4 py-3 text-sm font-semibold text-gray-800 text-left">Question</th>
        <th class="w-48 border-b border-gray-200 px-4 py-3 text-sm font-semibold text-gray-800 text-center">Answer</th>
      </tr>
    </thead>
    <tbody id="reportTableBody">
    </tbody>
  </table>
</div>
</div>
</section>

   <!-- Data Analysis Section -->
<section id="analysis" class="content-section hidden">
 {% include "chart/data_ananlysis.html" %}

</section>



<!-- JS for Sidebar Highlighting and Section Switching -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const links = document.querySelectorAll('.sidebar-link');
    const sections = document.querySelectorAll('main section');

    links.forEach(link => {
      link.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);

        sections.forEach(section => {
          section.classList.add('hidden');
          if (section.id === targetId) {
            section.classList.remove('hidden');
          }
        });

        links.forEach(l => l.classList.remove('text-indigo-700', 'font-semibold'));
        this.classList.add('text-indigo-700', 'font-semibold');
      });
    });
  });
</script>

{% block scripts %}

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const selector = document.getElementById('patientSelect');
    if (!selector) {
      console.error(" patientSelect not exsit!");
      return;
    }
  
    console.log("start fetch request");
    fetch('{{ url_for("chart.get_patient_names") }}')
      .then(res => res.json())
      .then(data => {
        console.log("Get patient data:", data);
        selector.innerHTML = '<option value="All">All</option>';
  
        for (const name of data) {
          const opt = document.createElement('option');
          opt.value = name;
          opt.textContent = name;
          selector.appendChild(opt);
        }
  
        console.log("Insertion complete. Current dropdown list HTML:", selector.innerHTML);
      })
      .catch(err => {
        console.error("Loading error", err);
      });
  });
  </script>
  
{% endblock %}

{% endblock %}